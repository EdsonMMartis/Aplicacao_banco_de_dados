-- CRIAR BASE DE DADOS
CREATE DATABASE ABD_03361_A_EdsonLuiz_GESTAO_ADVOCACIA_2025;
USE ABD_03361_A_EdsonLuiz_GESTAO_ADVOCACIA_2025;

-- TABELA ADVOGADOS
CREATE TABLE ADVOGADOS (
    ID INT PRIMARY KEY AUTO_INCREMENT,
    NOME VARCHAR(100),
    OAB VARCHAR(20),
    ESPECIALIDADE VARCHAR(100)
);

-- TABELA CLIENTES
CREATE TABLE CLIENTES (
    ID INT PRIMARY KEY AUTO_INCREMENT,
    NOME VARCHAR(100),
    CPF VARCHAR(14),
    CIDADE VARCHAR(100)
);

-- TABELA CASOS
CREATE TABLE CASOS (
    ID INT PRIMARY KEY AUTO_INCREMENT,
    ID_ADVOGADO INT,
    ID_CLIENTE INT,
    DESCRICAO TEXT,
    STATUS VARCHAR(50),
    DATA_ABERTURA DATE,
    FOREIGN KEY (ID_ADVOGADO) REFERENCES ADVOGADOS(ID),
    FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTES(ID)
);

-- TABELA AUDIENCIAS
CREATE TABLE AUDIENCIAS (
    ID INT PRIMARY KEY AUTO_INCREMENT,
    ID_CASO INT,
    DATA_AUDIENCIA DATE,
    LOCAL VARCHAR(100),
    RESULTADO VARCHAR(100),
    FOREIGN KEY (ID_CASO) REFERENCES CASOS(ID)
);

-- POPULAR TABELAS
INSERT INTO ADVOGADOS (NOME, OAB, ESPECIALIDADE) VALUES
('ADVOGADO 1', '10001/SP', 'ESPECIALIDADE 1'),
('ADVOGADO 2', '10002/SP', 'ESPECIALIDADE 2'),
('ADVOGADO 3', '10003/SP', 'ESPECIALIDADE 3'),
('ADVOGADO 4', '10004/SP', 'ESPECIALIDADE 4'),
('ADVOGADO 5', '10005/SP', 'ESPECIALIDADE 0'),
('ADVOGADO 6', '10006/SP', 'ESPECIALIDADE 1'),
('ADVOGADO 7', '10007/SP', 'ESPECIALIDADE 2'),
('ADVOGADO 8', '10008/SP', 'ESPECIALIDADE 3'),
('ADVOGADO 9', '10009/SP', 'ESPECIALIDADE 4'),
('ADVOGADO 10', '10010/SP', 'ESPECIALIDADE 0'),
('ADVOGADO 11', '10011/SP', 'ESPECIALIDADE 1'),
('ADVOGADO 12', '10012/SP', 'ESPECIALIDADE 2'),
('ADVOGADO 13', '10013/SP', 'ESPECIALIDADE 3'),
('ADVOGADO 14', '10014/SP', 'ESPECIALIDADE 4'),
('ADVOGADO 15', '10015/SP', 'ESPECIALIDADE 0'),
('ADVOGADO 16', '10016/SP', 'ESPECIALIDADE 1'),
('ADVOGADO 17', '10017/SP', 'ESPECIALIDADE 2'),
('ADVOGADO 18', '10018/SP', 'ESPECIALIDADE 3'),
('ADVOGADO 19', '10019/SP', 'ESPECIALIDADE 4'),
('ADVOGADO 20', '10020/SP', 'ESPECIALIDADE 0'),
('ADVOGADO 21', '10021/SP', 'ESPECIALIDADE 1'),
('ADVOGADO 22', '10022/SP', 'ESPECIALIDADE 2'),
('ADVOGADO 23', '10023/SP', 'ESPECIALIDADE 3'),
('ADVOGADO 24', '10024/SP', 'ESPECIALIDADE 4'),
('ADVOGADO 25', '10025/SP', 'ESPECIALIDADE 0'),
('ADVOGADO 26', '10026/SP', 'ESPECIALIDADE 1'),
('ADVOGADO 27', '10027/SP', 'ESPECIALIDADE 2'),
('ADVOGADO 28', '10028/SP', 'ESPECIALIDADE 3'),
('ADVOGADO 29', '10029/SP', 'ESPECIALIDADE 4'),
('ADVOGADO 30', '10030/SP', 'ESPECIALIDADE 0');

INSERT INTO CLIENTES (NOME, CPF, CIDADE) VALUES
('CLIENTE 1', '000.000.000-01', 'CIDADE 1'),
('CLIENTE 2', '000.000.000-02', 'CIDADE 2'),
('CLIENTE 3', '000.000.000-03', 'CIDADE 3'),
('CLIENTE 4', '000.000.000-04', 'CIDADE 4'),
('CLIENTE 5', '000.000.000-05', 'CIDADE 0'),
('CLIENTE 6', '000.000.000-06', 'CIDADE 1'),
('CLIENTE 7', '000.000.000-07', 'CIDADE 2'),
('CLIENTE 8', '000.000.000-08', 'CIDADE 3'),
('CLIENTE 9', '000.000.000-09', 'CIDADE 4'),
('CLIENTE 10', '000.000.000-10', 'CIDADE 0'),
('CLIENTE 11', '000.000.000-11', 'CIDADE 1'),
('CLIENTE 12', '000.000.000-12', 'CIDADE 2'),
('CLIENTE 13', '000.000.000-13', 'CIDADE 3'),
('CLIENTE 14', '000.000.000-14', 'CIDADE 4'),
('CLIENTE 15', '000.000.000-15', 'CIDADE 0'),
('CLIENTE 16', '000.000.000-16', 'CIDADE 1'),
('CLIENTE 17', '000.000.000-17', 'CIDADE 2'),
('CLIENTE 18', '000.000.000-18', 'CIDADE 3'),
('CLIENTE 19', '000.000.000-19', 'CIDADE 4'),
('CLIENTE 20', '000.000.000-20', 'CIDADE 0'),
('CLIENTE 21', '000.000.000-21', 'CIDADE 1'),
('CLIENTE 22', '000.000.000-22', 'CIDADE 2'),
('CLIENTE 23', '000.000.000-23', 'CIDADE 3'),
('CLIENTE 24', '000.000.000-24', 'CIDADE 4'),
('CLIENTE 25', '000.000.000-25', 'CIDADE 0'),
('CLIENTE 26', '000.000.000-26', 'CIDADE 1'),
('CLIENTE 27', '000.000.000-27', 'CIDADE 2'),
('CLIENTE 28', '000.000.000-28', 'CIDADE 3'),
('CLIENTE 29', '000.000.000-29', 'CIDADE 4'),
('CLIENTE 30', '000.000.000-30', 'CIDADE 0');

INSERT INTO CASOS (ID_ADVOGADO, ID_CLIENTE, DESCRICAO, STATUS, DATA_ABERTURA) VALUES
(22, 19, 'DESCRICAO DO CASO 1', 'EM ANDAMENTO', '2025-01-11'),
(14, 23, 'DESCRICAO DO CASO 2', 'EM ANDAMENTO', '2025-06-15'),
(2, 26, 'DESCRICAO DO CASO 3', 'ENCERRADO', '2025-11-02'),
(10, 25, 'DESCRICAO DO CASO 4', 'ENCERRADO', '2025-08-11'),
(29, 6, 'DESCRICAO DO CASO 5', 'ENCERRADO', '2025-08-28'),
(24, 28, 'DESCRICAO DO CASO 6', 'ENCERRADO', '2025-03-28'),
(28, 30, 'DESCRICAO DO CASO 7', 'EM ANDAMENTO', '2025-08-10'),
(3, 28, 'DESCRICAO DO CASO 8', 'ENCERRADO', '2025-06-21'),
(16, 7, 'DESCRICAO DO CASO 9', 'EM ANDAMENTO', '2025-02-04'),
(3, 30, 'DESCRICAO DO CASO 10', 'EM ANDAMENTO', '2025-12-20'),
(9, 27, 'DESCRICAO DO CASO 11', 'EM ANDAMENTO', '2025-11-27'),
(13, 27, 'DESCRICAO DO CASO 12', 'EM ANDAMENTO', '2025-01-03'),
(10, 28, 'DESCRICAO DO CASO 13', 'EM ANDAMENTO', '2025-09-24'),
(5, 17, 'DESCRICAO DO CASO 14', 'ENCERRADO', '2025-12-20'),
(14, 2, 'DESCRICAO DO CASO 15', 'EM ANDAMENTO', '2025-06-03'),
(18, 11, 'DESCRICAO DO CASO 16', 'EM ANDAMENTO', '2025-10-02'),
(14, 27, 'DESCRICAO DO CASO 17', 'ENCERRADO', '2025-09-03'),
(27, 4, 'DESCRICAO DO CASO 18', 'EM ANDAMENTO', '2025-07-21'),
(17, 24, 'DESCRICAO DO CASO 19', 'EM ANDAMENTO', '2025-09-24'),
(6, 5, 'DESCRICAO DO CASO 20', 'EM ANDAMENTO', '2025-10-31'),
(5, 11, 'DESCRICAO DO CASO 21', 'EM ANDAMENTO', '2025-02-17'),
(24, 7, 'DESCRICAO DO CASO 22', 'ENCERRADO', '2025-04-20'),
(16, 7, 'DESCRICAO DO CASO 23', 'ENCERRADO', '2025-11-14'),
(11, 13, 'DESCRICAO DO CASO 24', 'EM ANDAMENTO', '2025-08-12'),
(19, 14, 'DESCRICAO DO CASO 25', 'ENCERRADO', '2025-01-12'),
(3, 7, 'DESCRICAO DO CASO 26', 'EM ANDAMENTO', '2025-09-08'),
(8, 24, 'DESCRICAO DO CASO 27', 'EM ANDAMENTO', '2025-12-01'),
(8, 28, 'DESCRICAO DO CASO 28', 'EM ANDAMENTO', '2025-12-13'),
(27, 21, 'DESCRICAO DO CASO 29', 'ENCERRADO', '2025-08-05'),
(19, 1, 'DESCRICAO DO CASO 30', 'ENCERRADO', '2025-09-26');

INSERT INTO AUDIENCIAS (ID_CASO, DATA_AUDIENCIA, LOCAL, RESULTADO) VALUES
(23, '2025-09-26', 'LOCAL 1', 'EM ANDAMENTO'),
(16, '2025-02-24', 'LOCAL 2', 'ADIADA'),
(9, '2025-05-19', 'LOCAL 3', 'EM ANDAMENTO'),
(20, '2025-01-28', 'LOCAL 4', 'ADIADA'),
(18, '2025-11-04', 'LOCAL 0', 'ADIADA'),
(20, '2025-04-09', 'LOCAL 1', 'EM ANDAMENTO'),
(26, '2025-11-20', 'LOCAL 2', 'ENCERRADA'),
(8, '2025-07-15', 'LOCAL 3', 'ADIADA'),
(16, '2025-08-19', 'LOCAL 4', 'EM ANDAMENTO'),
(25, '2025-03-01', 'LOCAL 0', 'ENCERRADA'),
(14, '2025-04-17', 'LOCAL 1', 'EM ANDAMENTO'),
(16, '2026-01-01', 'LOCAL 2', 'ENCERRADA'),
(22, '2025-01-16', 'LOCAL 3', 'EM ANDAMENTO'),
(18, '2025-12-03', 'LOCAL 4', 'EM ANDAMENTO'),
(7, '2025-04-28', 'LOCAL 0', 'ENCERRADA'),
(4, '2025-01-07', 'LOCAL 1', 'ENCERRADA'),
(29, '2025-12-24', 'LOCAL 2', 'ENCERRADA'),
(26, '2025-07-23', 'LOCAL 3', 'ADIADA'),
(13, '2025-07-20', 'LOCAL 4', 'EM ANDAMENTO'),
(20, '2025-12-12', 'LOCAL 0', 'ADIADA'),
(24, '2025-07-13', 'LOCAL 1', 'ADIADA'),
(3, '2025-11-05', 'LOCAL 2', 'ENCERRADA'),
(7, '2025-12-18', 'LOCAL 3', 'ADIADA'),
(2, '2025-06-06', 'LOCAL 4', 'ADIADA'),
(20, '2025-02-09', 'LOCAL 0', 'ADIADA'),
(8, '2025-07-12', 'LOCAL 1', 'ENCERRADA'),
(30, '2025-12-24', 'LOCAL 2', 'ENCERRADA'),
(8, '2025-11-14', 'LOCAL 3', 'EM ANDAMENTO'),
(19, '2025-09-22', 'LOCAL 4', 'EM ANDAMENTO'),
(16, '2025-12-20', 'LOCAL 0', 'ENCERRADA');

-- CONSULTAS
-- 7
SELECT C.NOME AS CLIENTE, A.NOME AS ADVOGADO, CA.DESCRICAO
FROM CASOS CA
INNER JOIN CLIENTES C ON CA.ID_CLIENTE = C.ID
INNER JOIN ADVOGADOS A ON CA.ID_ADVOGADO = A.ID;

-- 8
SELECT C.NOME, CA.DESCRICAO
FROM CLIENTES C
LEFT JOIN CASOS CA ON C.ID = CA.ID_CLIENTE;

-- 9
SELECT CA.ID, CA.DESCRICAO, C.NOME
FROM CLIENTES C
RIGHT JOIN CASOS CA ON C.ID = CA.ID_CLIENTE;

-- 10
SELECT C.NOME AS CLIENTE, CA.DESCRICAO
FROM CLIENTES C
LEFT JOIN CASOS CA ON C.ID = CA.ID_CLIENTE
UNION
SELECT C.NOME AS CLIENTE, CA.DESCRICAO
FROM CLIENTES C
RIGHT JOIN CASOS CA ON C.ID = CA.ID_CLIENTE;

-- 11
SELECT A.NOME AS ADVOGADO, C.NOME AS CLIENTE
FROM ADVOGADOS A
CROSS JOIN CLIENTES C;

-- 12
SELECT CA.DESCRICAO, CA.STATUS, CA.DATA_ABERTURA, A.NOME AS ADVOGADO
FROM CASOS CA
INNER JOIN ADVOGADOS A ON CA.ID_ADVOGADO = A.ID
WHERE CA.STATUS = 'EM ANDAMENTO' AND CA.DATA_ABERTURA > '2025-01-01';

-- 13
SELECT A.NOME, COUNT(CA.ID) AS TOTAL_CASOS
FROM ADVOGADOS A
LEFT JOIN CASOS CA ON A.ID = CA.ID_ADVOGADO
GROUP BY A.NOME;

-- 14
SELECT NOME, CIDADE
FROM CLIENTES
ORDER BY NOME ASC;

-- 15
SELECT COUNT(*) AS TOTAL_AUDIENCIAS
FROM AUDIENCIAS;

-- 16
SELECT C.NOME, CA.DESCRICAO
FROM CLIENTES C
INNER JOIN CASOS CA ON C.ID = CA.ID_CLIENTE
WHERE C.CIDADE = 'S√ÉO PAULO';

-- 17
SELECT A.NOME
FROM ADVOGADOS A
LEFT JOIN CASOS CA ON A.ID = CA.ID_ADVOGADO
WHERE CA.ID IS NULL;

-- 18
SELECT STATUS, COUNT(*) AS TOTAL
FROM CASOS
GROUP BY STATUS;

-- 19
SELECT A.NOME, COUNT(CA.ID) AS TOTAL_CASOS
FROM ADVOGADOS A
JOIN CASOS CA ON A.ID = CA.ID_ADVOGADO
GROUP BY A.NOME
ORDER BY TOTAL_CASOS DESC
LIMIT 1;